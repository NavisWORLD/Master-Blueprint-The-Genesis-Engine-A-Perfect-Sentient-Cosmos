<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Genesis Engine - Safety Checks Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #000;
            color: #fff;
            padding: 20px;
        }
        .test-result {
            margin: 10px 0;
            padding: 10px;
            border-radius: 5px;
        }
        .success { background: #0a5; }
        .error { background: #a05; }
        .warning { background: #a50; }
        .info { background: #05a; }
    </style>
</head>
<body>
    <h1>üîí Genesis Engine - Safety Checks Test</h1>
    <div id="test-results"></div>

    <!-- Core Dependencies -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://unpkg.com/tone@14.7.77/build/Tone.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/simplex-noise/2.4.0/simplex-noise.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>

    <!-- Genesis Engine Core Modules -->
    <script src="modules/core/EventBus.js"></script>
    <script src="modules/core/Config.js"></script>
    <script src="modules/core/Utils.js"></script>
    <script src="modules/core/Token.js"></script>
    <script src="modules/core/TokenizationEngine.js"></script>
    
    <!-- Physics and Math -->
    <script src="modules/physics/UnifiedFormula.js"></script>
    <script src="modules/physics/UVO.js"></script>
    <script src="modules/physics/CST.js"></script>
    
    <!-- Audio and Sensory -->
    <script src="modules/sensory/AudioManager.js"></script>
    <script src="modules/sensory/SensoryInputManager.js"></script>
    
    <!-- Soul Dust System -->
    <script src="modules/soul-dust/SoulDustParticle.js"></script>
    <script src="modules/soul-dust/QuantumEventManager.js"></script>
    
    <!-- Rendering -->
    <script src="modules/rendering/Renderer.js"></script>
    <script src="modules/rendering/PostProcessor.js"></script>
    <script src="modules/rendering/Shaders.js"></script>
    
    <!-- AI and Creation -->
    <script src="modules/ai/AIConsciousness.js"></script>
    <script src="modules/ai/ProceduralGenerationEngine.js"></script>
    <script src="modules/ai/ObjectLibrary.js"></script>
    
    <!-- Universe Management -->
    <script src="modules/universe/UniverseManager.js"></script>
    <script src="modules/universe/CameraController.js"></script>
    <script src="modules/universe/InfiniteScaling.js"></script>
    
    <!-- Controls -->
    <script src="modules/controls/PlayerControls.js"></script>
    
    <!-- UI and Controls -->
    <script src="modules/ui/UIManager.js"></script>
    <script src="modules/ui/PerformanceMonitor.js"></script>
    
    <!-- Main Engine -->
    <script src="modules/GenesisEngine.js"></script>
    <script src="init_components.js"></script>

    <script>
        function addTestResult(message, type = 'success') {
            const resultsDiv = document.getElementById('test-results');
            const resultDiv = document.createElement('div');
            resultDiv.className = `test-result ${type}`;
            resultDiv.textContent = message;
            resultsDiv.appendChild(resultDiv);
        }

        async function runSafetyChecks() {
            console.log('üîí Starting safety checks test...');
            addTestResult('üîí Starting safety checks test...', 'info');

            // Test 1: Check if Utils is available and initialized
            addTestResult('Test 1: Checking Utils availability and initialization...');
            if (window.Utils) {
                addTestResult('‚úÖ Utils is available', 'success');
                
                if (window.Utils.isInitialized) {
                    addTestResult('‚úÖ Utils is initialized', 'success');
                } else {
                    addTestResult('‚ö†Ô∏è Utils is not initialized, initializing now...', 'warning');
                    window.Utils.initialize();
                    addTestResult('‚úÖ Utils initialized manually', 'success');
                }
                
                // Test Utils methods
                if (typeof window.Utils.randomPointInSphere === 'function') {
                    addTestResult('‚úÖ Utils.randomPointInSphere is available', 'success');
                } else {
                    addTestResult('‚ùå Utils.randomPointInSphere is not available', 'error');
                }
                
                if (typeof window.Utils.getConfig === 'function') {
                    addTestResult('‚úÖ Utils.getConfig is available', 'success');
                } else {
                    addTestResult('‚ùå Utils.getConfig is not available', 'error');
                }
                
                if (typeof window.Utils.generateUUID === 'function') {
                    addTestResult('‚úÖ Utils.generateUUID is available', 'success');
                } else {
                    addTestResult('‚ùå Utils.generateUUID is not available', 'error');
                }
            } else {
                addTestResult('‚ùå Utils is not available', 'error');
            }

            // Test 2: Check SoulDustParticle safety checks
            addTestResult('Test 2: Testing SoulDustParticle safety checks...');
            if (window.SoulDustParticle) {
                addTestResult('‚úÖ SoulDustParticle is available', 'success');
                
                try {
                    const testAudioData = {
                        frequency: 440,
                        amplitude: 0.5,
                        spectralComplexity: 0,
                        timestamp: performance.now(),
                        buffer: new Float32Array(1024)
                    };
                    
                    const testParticle = new window.SoulDustParticle(testAudioData);
                    addTestResult('‚úÖ SoulDustParticle created successfully', 'success');
                    
                    if (testParticle.position && typeof testParticle.position.x === 'number') {
                        addTestResult('‚úÖ SoulDustParticle position is valid', 'success');
                    } else {
                        addTestResult('‚ùå SoulDustParticle position is invalid', 'error');
                    }
                } catch (error) {
                    addTestResult(`‚ùå SoulDustParticle creation failed: ${error.message}`, 'error');
                }
            } else {
                addTestResult('‚ùå SoulDustParticle is not available', 'error');
            }

            // Test 3: Check ProceduralGenerationEngine safety checks
            addTestResult('Test 3: Testing ProceduralGenerationEngine safety checks...');
            if (window.ProceduralGenerationEngine) {
                addTestResult('‚úÖ ProceduralGenerationEngine is available', 'success');
                
                try {
                    // Test the generateRandomObject method
                    const testSector = {
                        position: { x: 0, y: 0, z: 0 }
                    };
                    
                    const testObject = window.ProceduralGenerationEngine.generateRandomObject(testSector);
                    addTestResult('‚úÖ ProceduralGenerationEngine.generateRandomObject works', 'success');
                    
                    if (testObject && testObject.id) {
                        addTestResult('‚úÖ Generated object has valid ID', 'success');
                    } else {
                        addTestResult('‚ùå Generated object has invalid ID', 'error');
                    }
                } catch (error) {
                    addTestResult(`‚ùå ProceduralGenerationEngine test failed: ${error.message}`, 'error');
                }
            } else {
                addTestResult('‚ùå ProceduralGenerationEngine is not available', 'error');
            }

            // Test 4: Check ObjectLibrary safety checks
            addTestResult('Test 4: Testing ObjectLibrary safety checks...');
            if (window.ObjectLibrary) {
                addTestResult('‚úÖ ObjectLibrary is available', 'success');
                
                try {
                    window.ObjectLibrary.loadObjectTypes();
                    addTestResult('‚úÖ ObjectLibrary.loadObjectTypes works', 'success');
                } catch (error) {
                    addTestResult(`‚ùå ObjectLibrary test failed: ${error.message}`, 'error');
                }
            } else {
                addTestResult('‚ùå ObjectLibrary is not available', 'error');
            }

            // Test 5: Check UniverseManager safety checks
            addTestResult('Test 5: Testing UniverseManager safety checks...');
            if (window.UniverseManager) {
                addTestResult('‚úÖ UniverseManager is available', 'success');
                
                try {
                    window.UniverseManager.updateConfiguration();
                    addTestResult('‚úÖ UniverseManager.updateConfiguration works', 'success');
                } catch (error) {
                    addTestResult(`‚ùå UniverseManager test failed: ${error.message}`, 'error');
                }
            } else {
                addTestResult('‚ùå UniverseManager is not available', 'error');
            }

            // Test 6: Check InfiniteScaling safety checks
            addTestResult('Test 6: Testing InfiniteScaling safety checks...');
            if (window.InfiniteScaling) {
                addTestResult('‚úÖ InfiniteScaling is available', 'success');
                
                try {
                    window.InfiniteScaling.updateConfiguration();
                    addTestResult('‚úÖ InfiniteScaling.updateConfiguration works', 'success');
                } catch (error) {
                    addTestResult(`‚ùå InfiniteScaling test failed: ${error.message}`, 'error');
                }
            } else {
                addTestResult('‚ùå InfiniteScaling is not available', 'error');
            }

            // Test 7: Check SensoryInputManager safety checks
            addTestResult('Test 7: Testing SensoryInputManager safety checks...');
            if (window.SensoryInputManager) {
                addTestResult('‚úÖ SensoryInputManager is available', 'success');
                
                try {
                    // Test the generateSoulDustParticle method
                    window.SensoryInputManager.generateSoulDustParticle();
                    addTestResult('‚úÖ SensoryInputManager.generateSoulDustParticle works', 'success');
                } catch (error) {
                    addTestResult(`‚ùå SensoryInputManager test failed: ${error.message}`, 'error');
                }
            } else {
                addTestResult('‚ùå SensoryInputManager is not available', 'error');
            }

            // Test 8: Check GenesisEngine initialization
            addTestResult('Test 8: Testing GenesisEngine initialization with safety checks...');
            if (window.GenesisEngine) {
                addTestResult('‚úÖ GenesisEngine is available', 'success');
                
                try {
                    await window.GenesisEngine.initialize();
                    addTestResult('‚úÖ GenesisEngine initialized successfully with safety checks', 'success');
                } catch (error) {
                    addTestResult(`‚ùå GenesisEngine initialization failed: ${error.message}`, 'error');
                    console.error('GenesisEngine initialization error:', error);
                }
            } else {
                addTestResult('‚ùå GenesisEngine is not available', 'error');
            }

            addTestResult('üèÅ All safety checks completed', 'info');
        }

        // Run tests when page loads
        document.addEventListener('DOMContentLoaded', runSafetyChecks);
    </script>
</body>
</html> 